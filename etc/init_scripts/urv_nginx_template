server {
    listen 80;

    root /usr/share/nginx/html;
    index index.html index.htm;

    error_page 404 /404.html;
    client_max_body_size 50m;

    server_name  urv-%s.mindandmachine.ru;

    location / {
         root /var/www/servers/%s/time_attendance/frontend;
    }

    location /api/ {
        uwsgi_pass unix:///var/servers/%s/backend/uwsgi.sock;
        include uwsgi_params;
    }

    location /admin/ {
        uwsgi_pass unix:///var/servers/%s/backend/uwsgi.sock;
        include uwsgi_params;
    }


    location /image/ {
        alias /var/www/servers/%s/media/;
    }

    location /static/admin/ {
        alias /var/www/servers/%s/admin/;
    }

    if ($scheme = http) { return 301 https://$server_name$request_uri; }
    listen 443 ssl;
    ssl_certificate %s;
    ssl_certificate_key %s;
    access_log /var/log/nginx/%s-urv-access.log;
    error_log /var/log/nginx/%s-urv-error.log;
}
